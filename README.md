# java-explore-with-me
[Сcылка на PR](https://www.google.com).

## Сервисы

<img src=".\assets\images\architect.jpg" alt="Архитектура" width="450" height="250"/>

Сервисы:
* `ewm-service` —  основной сервис, связан с модулем `ewm-main-service`;
* `HTTPClient` — клиент внутри основного сервиса для связи с сервисом статистики;
* `stats-server` — сервис статистики, связан с модулем `ewm-stats-service`;
* `ewm-db` - сервис бд для основного сервиса, зависит от основного сервиса;
* `stats-db` - сервис бд для статистики, зависит от сервиса статистики.

Предполагается, что сервисы `ExploreWithMe` уже находятся за системой аутентификации и авторизации.
Поэтому любой запрос к закрытой или административной части является валидным с точки зрения аутентификации
и авторизации.

### Основной сервис
API основного сервиса разделите на три части. Первая — публичная, доступна без регистрации любому пользователю сети.
Вторая — закрытая, доступна только авторизованным пользователям. Третья — административная,
для администраторов сервиса. К каждой из частей свои требования.

#### Публичный API
Публичный API должен предоставлять возможности поиска и фильтрации событий.
1. Сортировка списка событий должна быть организована либо по количеству просмотров, которое должно запрашиваться в
сервисе статистики, либо по датам событий.
2. При просмотре списка событий возвращается только краткая информация о мероприятиях.
3. Просмотр подробной информации о конкретном событии нужно настроить отдельно (через отдельный эндпоинт).
4. Каждое событие должно относиться к какой-то из закреплённых в приложении категорий.
5. Должна быть настроена возможность получения всех имеющихся категорий и подборок событий (такие подборки будут
составлять администраторы ресурса).
6. Каждый публичный запрос для получения списка событий или полной информации о мероприятии должен фиксироваться
сервисом статистики.

#### Авторизированный API
Закрытая часть API призвана реализовать возможности зарегистрированных пользователей продукта.
1. Авторизованные пользователи должны иметь возможность добавлять в приложение новые мероприятия, редактировать их и
просматривать после добавления.
2. Должна быть настроена подача заявок на участие в интересующих мероприятиях.
3. Создатель мероприятия должен иметь возможность подтверждать заявки, которые отправили другие пользователи сервиса.

#### Административный API
Административная часть API должна предоставлять возможности настройки и поддержки работы сервиса.
1. Нужно настроить добавление, изменение и удаление категорий для событий.
2. Должна появиться возможность добавлять, удалять и закреплять на главной странице подборки мероприятий.
3. Требуется наладить модерацию событий, размещённых пользователями, — публикация или отклонение.
4. Также должно быть настроено управление пользователями — добавление, просмотр и удаление.

### Сервис статистики
Сервис статистики призван собирать информацию:
1. О количестве обращений пользователей к спискам событий.
2. О количестве запросов к подробной информации о событии.

Функционал сервиса статистики должен содержать:
* запись информации о том, что был обработан запрос к эндпоинту API;
* предоставление статистики за выбранные даты по выбранному эндпоинту.

Эндпоинты для статистики:
* `GET /events`, который отвечает за получение событий с возможностью фильтрации;
* `GET /events/{id}`, который позволяет получить подробную информацию об опубликованном событии по его идентификатору.

### Сервис клиента

Должен быть разработан HTTP-клиент на основе RestTemplate, который отправляет запросы и обрабатывает ответы между
сервисом статистики и основным сервисом.

HTTP-клиент находится внутри основного сервиса `ewm-service`,
который взаимодействует с сервисом статистики и основным сервисом. 

## Модель
<img src=".\assets\images\postgres.jpg" alt="ERM" width="900" height="900"/>
 
### Сущности
Представлены следующие сущности в ERM(Entity–relationship model) основного сервиса:
* `users` характеризует пользователей.
* `compilations` характеризует конкретные подборки событий.
* `categories` характеризует категории.
* `events` характеризует события.
* `compilation_event` характеризует связь подборки событий с событиями.
* `requests` характеризует заявки на участия в событиях.

### Жизненый цикл события
1. Создание
2. Ожидание публикации. В статус ожидания публикации событие переходит сразу после создания.
3. Публикация. В это состояние событие переводит администратор.
4. Отмена публикации. В это состояние событие переходит в двух случаях. Первый — если администратор решил,
что его нельзя публиковать. Второй — когда инициатор события решил отменить его на этапе ожидания публикации.

## Структура проекта
Расположение пакетов в проекте выбрано по фичам (package by feature).

## Общий план разработки
### Эпики:
- [ ] **Проектирование и подготовка к запуску многомодульного проекта.**
- [ ] **Добавление необходимых зависимостей в pom файле.**
- [ ] **Подключние БД и проектирование ERM для статистики и основного сервиса.**
- [ ] **Реализация функционала пользователей.**
- [ ] **Реализация функционала категорий.**
- [ ] **Реализация функционала событий.**
- [ ] **Реализация функционала подборок событий.**
- [ ] **Реализация функционала запросов участия в событиях.**
- [ ] **Доработка клиента статистики.**
- [ ] **Добавление учета статистики.**
- [ ] **Реализация выбранной дополнительной фичи.**
- [ ] **Добавление недостающих тестов.**    